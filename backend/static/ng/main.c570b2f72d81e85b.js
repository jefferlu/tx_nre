"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[179],{8236:(g,v,o)=>{o.d(v,{e:()=>w});var l=o(2843),d=o(3900),e=o(9646),n=o(262),a=o(2340),m=o(705),u=o(2223),h=o(3144),y=o(3469),A=o(4707),T=o(8505),R=o(4004);const U=a.N.user_key;let C=(()=>{class c{constructor(r){this._httpClient=r,this._user=new A.t(1)}set user(r){localStorage.setItem(U,JSON.stringify(r))}get user$(){let r=localStorage.getItem(U);return this._user.next(r?JSON.parse(r):""),this._user.asObservable()}get(){return this._httpClient.get("api/common/user").pipe((0,T.b)(r=>{this._user.next(r)}))}update(r){return this._httpClient.patch("api/common/user",{user:r}).pipe((0,R.U)(p=>{this._user.next(p)}))}}return c.\u0275fac=function(r){return new(r||c)(u.LFG(h.eN))},c.\u0275prov=u.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})();const I=a.N.apiUrl,k=a.N.user_key;let w=(()=>{class c{constructor(r,p,F){this._httpClient=r,this._cookieService=p,this._userService=F,this._authenticated=!1}set token(r){this._cookieService.set("access",r.access),this._cookieService.set("refresh",r.refresh)}forgotPassword(r){return this._httpClient.post("api/auth/forgot-password",r)}resetPassword(r){return this._httpClient.post("api/auth/reset-password",r)}signIn(r){return this._authenticated?(0,l._)(()=>new Error("User is already logged in.")):(console.log(`${I}/login`),this._httpClient.post(`${I}/login`,r).pipe((0,d.w)(p=>(this.token=p,this._authenticated=!0,this._userService.user=p.user,(0,e.of)(p)))))}signInUsingToken(){return this._httpClient.post(`${I}/token/refresh`,{refresh:this._cookieService.get("refresh")}).pipe((0,n.K)(()=>(0,e.of)(!1)),(0,d.w)(r=>(r.access&&(this.token=r),this._authenticated=!0,(0,e.of)(!0))))}signOut(){return localStorage.removeItem(k),this._cookieService.delete("access"),this._cookieService.delete("refresh"),this._authenticated=!1,(0,e.of)(!0)}signUp(r){return this._httpClient.post("api/auth/sign-up",r)}unlockSession(r){return this._httpClient.post("api/auth/unlock-session",r)}check(){return this._authenticated?(0,e.of)(!0):!this._cookieService.get("access")||m.l.isTokenExpired(this._cookieService.get("access"))?(0,e.of)(!1):this.signInUsingToken()}}return c.\u0275fac=function(r){return new(r||c)(u.LFG(h.eN),u.LFG(y.N),u.LFG(C))},c.\u0275prov=u.Yz7({token:c,factory:c.\u0275fac}),c})()},705:(g,v,o)=>{o.d(v,{l:()=>l});class l{constructor(){}static isTokenExpired(e,n){if(!e||""===e)return!0;const a=this._getTokenExpirationDate(e);return n=n||0,null===a||!(a.valueOf()>(new Date).valueOf()+1e3*n)}static _b64decode(e){let a="";if((e=String(e).replace(/=+$/,"")).length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(let u,h,m=0,y=0;h=e.charAt(y++);~h&&(u=m%4?64*u+h:h,m++%4)?a+=String.fromCharCode(255&u>>(-2*m&6)):0)h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(h);return a}static _b64DecodeUnicode(e){return decodeURIComponent(Array.prototype.map.call(this._b64decode(e),n=>"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)).join(""))}static _urlBase64Decode(e){let n=e.replace(/-/g,"+").replace(/_/g,"/");switch(n.length%4){case 0:break;case 2:n+="==";break;case 3:n+="=";break;default:throw Error("Illegal base64url string!")}return this._b64DecodeUnicode(n)}static _decodeToken(e){if(!e)return null;const n=e.split(".");if(3!==n.length)throw new Error("The inspected token doesn't appear to be a JWT. Check to make sure it has three parts and see https://jwt.io for more.");const a=this._urlBase64Decode(n[1]);if(!a)throw new Error("Cannot decode the token.");return JSON.parse(a)}static _getTokenExpirationDate(e){const n=this._decodeToken(e);if(!n.hasOwnProperty("exp"))return null;const a=new Date(0);return a.setUTCSeconds(n.exp),a}}},2340:(g,v,o)=>{o.d(v,{N:()=>l});const l={production:!0,apiUrl:"api",user_key:"gc_erp_user",staticUrl:"static/ng/",mediaUrl:"media/"}},7497:(g,v,o)=>{var l=o(6550),d=o(7179),e=o(2223);let n=(()=>{class t{}return t.\u0275fac=function(s){return new(s||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-layout"]],decls:2,vars:0,template:function(s,f){1&s&&(e.TgZ(0,"p"),e._uU(1,"layout works!"),e.qZA())},styles:["layout[_ngcontent-%COMP%]{display:flex;flex:1 1 auto;width:100%;max-width:100%;min-width:0}layout[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{position:relative;display:flex;flex:1 1 auto;width:100%}layout[_ngcontent-%COMP%]   router-outlet[_ngcontent-%COMP%] + *[_ngcontent-%COMP%]{position:relative;display:flex;flex:1 1 auto;width:100%}"]}),t})();var a=o(3900),m=o(9646),u=o(8236);const A={preloadingStrategy:d.wm,scrollPositionRestoration:"enabled"},T=[{path:"",pathMatch:"full",redirectTo:"nre"},{path:"signed-in-redirect",pathMatch:"full",redirectTo:"nre"},{path:"",children:[{path:"sign-in",loadChildren:()=>Promise.all([o.e(511),o.e(526)]).then(o.bind(o,8526)).then(t=>t.SignInModule)}]},{path:"",canMatch:[(t,i)=>(t=>{const i=(0,e.f3M)(u.e),s=(0,e.f3M)(d.F0);return i.check().pipe((0,a.w)(f=>{if(!f){const x=`/${t.join("/")}`,S=s.parseUrl(`sign-in?redirectURL=${x}`);return(0,m.of)(S)}return(0,m.of)(!0)}))})(i)],component:n,children:[{path:"nre",loadChildren:()=>Promise.all([o.e(511),o.e(573)]).then(o.bind(o,2573)).then(t=>t.NreModule)}]}];let R=(()=>{class t{}return t.\u0275fac=function(s){return new(s||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[d.Bz.forRoot(T,A),d.Bz]}),t})(),N=(()=>{class t{constructor(){this.title="client"}}return t.\u0275fac=function(s){return new(s||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-root"]],decls:1,vars:0,template:function(s,f){1&s&&e._UZ(0,"router-outlet")},dependencies:[d.lC],styles:["svg#clouds[_ngcontent-%COMP%]{position:fixed;bottom:-160px;left:-230px;z-index:-10;width:1920px}"]}),t})();var U=o(4275),C=o(3144),I=o(262),k=o(2843),w=o(705),c=o(3469);let M=(()=>{class t{constructor(s,f){this._cookieService=s,this._authService=f}intercept(s,f){let x=s.clone();return this._cookieService.get("access")&&!w.l.isTokenExpired(this._cookieService.get("access"))&&(x=s.clone({headers:s.headers.set("Authorization",`Bearer ${this._cookieService.get("access")}`)})),f.handle(x).pipe((0,I.K)(S=>(S instanceof C.UA&&401===S.status&&(this._authService.signOut(),S.url.includes("api/login")||location.reload()),(0,k._)(()=>S))))}}return t.\u0275fac=function(s){return new(s||t)(e.LFG(c.N),e.LFG(u.e))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac}),t})(),r=(()=>{class t{}return t.\u0275fac=function(s){return new(s||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({providers:[u.e,{provide:C.TP,useClass:M,multi:!0}],imports:[C.JF]}),t})();var p=o(430);let F=(()=>{class t{constructor(s,f){this._domSanitizer=s,this._matIconRegistry=f,this._matIconRegistry.addSvgIconSet(this._domSanitizer.bypassSecurityTrustResourceUrl("assets/icons/material-twotone.svg")),this._matIconRegistry.addSvgIconSetInNamespace("mat_outline",this._domSanitizer.bypassSecurityTrustResourceUrl("assets/icons/material-outline.svg")),this._matIconRegistry.addSvgIconSetInNamespace("mat_solid",this._domSanitizer.bypassSecurityTrustResourceUrl("assets/icons/material-solid.svg")),this._matIconRegistry.addSvgIconSetInNamespace("feather",this._domSanitizer.bypassSecurityTrustResourceUrl("assets/icons/feather.svg")),this._matIconRegistry.addSvgIconSetInNamespace("heroicons_outline",this._domSanitizer.bypassSecurityTrustResourceUrl("assets/icons/heroicons-outline.svg")),this._matIconRegistry.addSvgIconSetInNamespace("heroicons_solid",this._domSanitizer.bypassSecurityTrustResourceUrl("assets/icons/heroicons-solid.svg"))}}return t.\u0275fac=function(s){return new(s||t)(e.LFG(l.H7),e.LFG(p.jv))},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({}),t})(),O=(()=>{class t{}return t.\u0275fac=function(s){return new(s||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[r,F]}),t})(),E=(()=>{class t{}return t.\u0275fac=function(s){return new(s||t)},t.\u0275mod=e.oAB({type:t,bootstrap:[N]}),t.\u0275inj=e.cJS({imports:[l.b2,U.PW,R,O]}),t})();l.q6().bootstrapModule(E).catch(t=>console.error(t))}},g=>{g.O(0,[736],()=>g(g.s=7497)),g.O()}]);